<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NLQ to BigQuery ë¶„ì„ ì„œë¹„ìŠ¤ ë©”ì»¤ë‹ˆì¦˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.8.1/flowbite.min.css" rel="stylesheet" />
    <style>
        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .flow-chart-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }
        .flow-chart-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            width: 100%;
            max-width: 600px;
            min-height: 120px;
            position: relative;
        }
        .flow-arrow {
            font-size: 2rem;
            color: #9ca3af;
            margin: 0.5rem 0;
        }
        .tech-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-top: 0.75rem;
        }
        .section-title {
            font-size: 1.875rem;
            font-weight: 700;
            color: #111827;
            border-bottom: 2px solid #4f46e5;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }
        .step-explanation {
            border-left: 4px solid #4f46e5;
            padding-left: 1rem;
            margin-bottom: 1.5rem;
        }
        .code-snippet {
            display: block;
            background-color: #1f2937;
            color: #e5e7eb;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.875rem;
            white-space: pre-wrap;
            overflow-x: auto;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 p-4 sm:p-6 md:p-8">
    <div class="max-w-4xl mx-auto bg-white p-8 rounded-2xl shadow-lg">

        <header class="text-center mb-12">
            <h1 class="text-4xl font-extrabold text-gray-900 mb-2">ìì—°ì–´ - ë¹…ì¿¼ë¦¬ ì¡°íšŒ ë° ë¶„ì„ ì„œë¹„ìŠ¤ ì†Œê°œ</h1>
            <p class="text-lg text-gray-600">LLMì„ í™œìš©í•˜ì—¬ SQLì„ ìƒì„±í•˜ì—¬ BigQueryë¥¼ ì¡°íšŒ, ì¡°íšŒëœ ë°ì´í„°ë¥¼ ë‹¤ì‹œ LLMìœ¼ë¡œ ë¶„ì„</p>
        </header>

        <!-- 1. í”Œë¡œìš° ì°¨íŠ¸ -->
        <section class="mb-12">
            <h2 class="section-title">ì„œë¹„ìŠ¤ ì‘ë™ í”Œë¡œìš°</h2>
            <div class="flow-chart-container">
                <!-- Step 1: User Input -->
                <div class="flow-chart-item bg-indigo-50 border border-indigo-200">
                    <div class="text-2xl mb-2">ğŸ‘¤</div>
                    <h3 class="text-lg font-semibold text-indigo-800">1. ì‚¬ìš©ì ì§ˆë¬¸ ì…ë ¥</h3>
                    <p class="text-sm text-indigo-700">ì›¹ ì¸í„°í˜ì´ìŠ¤(HTML)ì—ì„œ ìì—°ì–´ë¡œ ì§ˆë¬¸ì„ ì…ë ¥í•©ë‹ˆë‹¤.</p>
                    <span class="tech-badge bg-indigo-200 text-indigo-800">Frontend (HTML, JS)</span>
                </div>
                <div class="flow-arrow">â¬‡ï¸</div>

                <!-- Step 2: Backend Request -->
                <div class="flow-chart-item bg-gray-50 border border-gray-200">
                    <div class="text-2xl mb-2">ğŸ–¥ï¸</div>
                    <h3 class="text-lg font-semibold text-gray-800">2. ë°±ì—”ë“œ API ìš”ì²­</h3>
                    <p class="text-sm text-gray-700">JavaScriptê°€ ì‚¬ìš©ìì˜ ì§ˆë¬¸ì„ Flask ë°±ì—”ë“œ ì„œë²„ë¡œ ì „ì†¡í•©ë‹ˆë‹¤.</p>
                    <span class="tech-badge bg-gray-200 text-gray-800">Backend (Flask)</span>
                </div>
                <div class="flow-arrow">â¬‡ï¸</div>

                <!-- Step 3: NLQ to SQL -->
                <div class="flow-chart-item bg-purple-50 border border-purple-200">
                    <div class="text-2xl mb-2">ğŸ¤–</div>
                    <h3 class="text-lg font-semibold text-purple-800">3. ìì—°ì–´ â¡ï¸ SQL ë³€í™˜</h3>
                    <p class="text-sm text-purple-700">Flask ì„œë²„ê°€ Anthropic Claude 3.5 Sonnet ëª¨ë¸ì„ í˜¸ì¶œí•˜ì—¬ ìì—°ì–´ ì§ˆë¬¸ì„ BigQuery SQLë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>
                    <span class="tech-badge bg-purple-200 text-purple-800">AI (Claude 3.5)</span>
                </div>
                <div class="flow-arrow">â¬‡ï¸</div>

                <!-- Step 4: Execute Query -->
                <div class="flow-chart-item bg-blue-50 border border-blue-200">
                    <div class="text-2xl mb-2">ğŸ—ƒï¸</div>
                    <h3 class="text-lg font-semibold text-blue-800">4. BigQuery ì¿¼ë¦¬ ì‹¤í–‰</h3>
                    <p class="text-sm text-blue-700">ìƒì„±ëœ SQLì„ Google BigQueryì—ì„œ ì‹¤í–‰í•˜ì—¬ ë°ì´í„°ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.</p>
                    <span class="tech-badge bg-blue-200 text-blue-800">Database (BigQuery)</span>
                </div>
                <div class="flow-arrow">â¬‡ï¸</div>

                <!-- Step 5: Process & Analyze -->
                <div class="flow-chart-item bg-green-50 border border-green-200">
                    <div class="text-2xl mb-2">ğŸ’¡</div>
                    <h3 class="text-lg font-semibold text-green-800">5. ê²°ê³¼ ë¶„ì„ ë° ì‹œê°í™” ìƒì„±</h3>
                    <p class="text-sm text-green-700">ì¡°íšŒëœ ë°ì´í„°ë¥¼ ë‹¤ì‹œ Claude ëª¨ë¸ì— ì „ë‹¬í•˜ì—¬ ë¶„ì„ ë¦¬í¬íŠ¸, ì¸ì‚¬ì´íŠ¸, ì°¨íŠ¸ ì„¤ì •, ë˜ëŠ” ì™„ì „í•œ HTML ë¬¸ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
                    <span class="tech-badge bg-green-200 text-green-800">AI (Claude 3.5) & Backend (Python)</span>
                </div>
                <div class="flow-arrow">â¬‡ï¸</div>

                <!-- Step 6: Display Results -->
                <div class="flow-chart-item bg-yellow-50 border border-yellow-200">
                    <div class="text-2xl mb-2">ğŸ“ˆ</div>
                    <h3 class="text-lg font-semibold text-yellow-800">6. ìµœì¢… ê²°ê³¼ í‘œì‹œ</h3>
                    <p class="text-sm text-yellow-700">ë°±ì—”ë“œê°€ ì²˜ë¦¬ëœ ìµœì¢… ê²°ê³¼ë¥¼ í”„ë¡ íŠ¸ì—”ë“œë¡œ ì „ì†¡í•˜ê³ , JavaScriptê°€ ì´ë¥¼ ë™ì ìœ¼ë¡œ í™”ë©´ì— ë Œë”ë§í•©ë‹ˆë‹¤. (ë°ì´í„° í…Œì´ë¸”, ì°¨íŠ¸, ë¶„ì„ ë¦¬í¬íŠ¸ ë“±)</p>
                    <span class="tech-badge bg-yellow-200 text-yellow-800">Frontend (JS, Chart.js)</span>
                </div>
            </div>
        </section>

        <!-- 2. ë‹¨ê³„ë³„ ìƒì„¸ ì„¤ëª… -->
        <section class="mb-12">
            <h2 class="section-title">ë‹¨ê³„ë³„ ìƒì„¸ ì„¤ëª…</h2>
            
            <div class="step-explanation">
                <h3 class="text-xl font-semibold mb-2">1. ì‚¬ìš©ì ì§ˆë¬¸ ì…ë ¥ (Frontend)</h3>
                <p>ì‚¬ìš©ìëŠ” ì›¹ ë¸Œë¼ìš°ì €ì— í‘œì‹œëœ UI (`index.html`)ì˜ í…ìŠ¤íŠ¸ ì…ë ¥ì°½ì— "ê°€ì¥ ë§ì´ ë°œìƒí•œ ì´ë²¤íŠ¸ëŠ”?"ê³¼ ê°™ì€ ìì—°ì–´ ì§ˆë¬¸ì„ ì…ë ¥í•©ë‹ˆë‹¤. ì˜ˆì‹œ ì§ˆë¬¸ì„ í´ë¦­í•˜ì—¬ ì…ë ¥í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>
                <code class="code-snippet text-sm">// static/js/main.js
quickBtn.addEventListener('click', () => executeQuery('quick'));
structuredBtn.addEventListener('click', () => executeQuery('structured'));
creativeBtn.addEventListener('click', () => executeQuery('creative'));</code>
            </div>

            <div class="step-explanation">
                <h3 class="text-xl font-semibold mb-2">2. ë°±ì—”ë“œ API ìš”ì²­ (Flask)</h3>
                <p>ì‚¬ìš©ìê°€ ë¶„ì„ ëª¨ë“œ ë²„íŠ¼(ë¹ ë¥¸ ì¡°íšŒ, êµ¬ì¡°í™” ë¶„ì„, ì°½ì˜ì  HTML) ì¤‘ í•˜ë‚˜ë¥¼ í´ë¦­í•˜ë©´, `main.js`ì˜ `executeQuery` í•¨ìˆ˜ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ì„ íƒëœ ëª¨ë“œì™€ ì§ˆë¬¸ ë‚´ìš©ì„ ë‹´ì•„ Flask ë°±ì—”ë“œì˜ í•´ë‹¹ API ì—”ë“œí¬ì¸íŠ¸(`/quick`, `/analyze`, `/creative-html`)ë¡œ POST ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.</p>
                <code class="code-snippet text-sm"># app.py
@app.route('/analyze', methods=['POST'])
def structured_analysis():
    question = request.json['question'].strip()
    # ... (í›„ëµ)</code>
            </div>

            <div class="step-explanation">
                <h3 class="text-xl font-semibold mb-2">3. ìì—°ì–´ â¡ï¸ SQL ë³€í™˜ (Claude 3.5)</h3>
                <p>Flask ë°±ì—”ë“œëŠ” `natural_language_to_sql` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ì‚¬ì „ì— ì •ì˜ëœ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸(í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ì •ë³´, SQL ìƒì„± ê·œì¹™ ë“±)ì™€ ì‚¬ìš©ìì˜ ì§ˆë¬¸ì„ í•¨ê»˜ Anthropic Claude 3.5 Sonnet ëª¨ë¸ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤. ëª¨ë¸ì€ ì´ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ BigQueryì—ì„œ ì‹¤í–‰ ê°€ëŠ¥í•œ í‘œì¤€ SQL ì¿¼ë¦¬ë¥¼ ìƒì„±í•˜ì—¬ ë°˜í™˜í•©ë‹ˆë‹¤.</p>
                 <code class="code-snippet text-sm"># app.py - natural_language_to_sql(question)
system_prompt = get_sql_generation_system_prompt()
response = anthropic_client.messages.create(
    model="claude-3-5-sonnet-20241022",
    system=system_prompt,
    messages=[{"role": "user", "content": question}]
)
sql_query = response.content[0].text.strip()
return sql_query</code>
            </div>

            <div class="step-explanation">
                <h3 class="text-xl font-semibold mb-2">4. BigQuery ì¿¼ë¦¬ ì‹¤í–‰ (Database)</h3>
                <p>`execute_bigquery` í•¨ìˆ˜ê°€ ìƒì„±ëœ SQL ì¿¼ë¦¬ë¥¼ Google Cloudì˜ BigQuery ì„œë¹„ìŠ¤ë¡œ ì „ë‹¬í•˜ì—¬ ì‹¤í–‰í•©ë‹ˆë‹¤. BigQueryëŠ” ëŒ€ìš©ëŸ‰ ë°ì´í„°ë¥¼ ë¹ ë¥´ê²Œ ì²˜ë¦¬í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ Python ê°ì²´ í˜•íƒœë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.</p>
                 <code class="code-snippet text-sm"># app.py - execute_bigquery(sql_query)
query_job = bigquery_client.query(sql_query)
results = query_job.result() # ì¿¼ë¦¬ ì‹¤í–‰ ë° ê²°ê³¼ ê°€ì ¸ì˜¤ê¸°
rows = [dict(row) for row in results] # ê²°ê³¼ë¥¼ ë”•ì…”ë„ˆë¦¬ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜
return {"success": True, "data": rows}</code>
            </div>

            <div class="step-explanation">
                <h3 class="text-xl font-semibold mb-2">5. ê²°ê³¼ ë¶„ì„ ë° ì‹œê°í™” ìƒì„± (Claude 3.5 & Python)</h3>
                <p>ì´ ë‹¨ê³„ëŠ” ì‚¬ìš©ìê°€ ì„ íƒí•œ ëª¨ë“œì— ë”°ë¼ ë‹¤ë¥´ê²Œ ë™ì‘í•©ë‹ˆë‹¤.</p>
                <ul class="list-disc list-inside mt-2 space-y-2">
                    <li><strong>ë¹ ë¥¸ ì¡°íšŒ:</strong> ì´ ë‹¨ê³„ë¥¼ ê±´ë„ˆë›°ê³  ì¡°íšŒëœ ë°ì´í„°ë¥¼ ë°”ë¡œ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ê¹ë‹ˆë‹¤.</li>
                    <li><strong>êµ¬ì¡°í™” ë¶„ì„:</strong> `generate_analysis_report` í•¨ìˆ˜ê°€ í˜¸ì¶œë©ë‹ˆë‹¤. ì¡°íšŒëœ ë°ì´í„°ì˜ ìƒ˜í”Œê³¼ í†µê³„ ì •ë³´ë¥¼ Claude ëª¨ë¸ì— ì „ë‹¬í•˜ì—¬ í…ìŠ¤íŠ¸ ê¸°ë°˜ì˜ ë¶„ì„ ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•˜ê³ , `suggest_chart_config` í•¨ìˆ˜ê°€ ë°ì´í„° êµ¬ì¡°ë¥¼ ë¶„ì„í•´ ì ì ˆí•œ ì°¨íŠ¸(ë§‰ëŒ€, ì„  ë“±) ì„¤ì •ì„ ì œì•ˆí•©ë‹ˆë‹¤.</li>
                    <li><strong>ì°½ì˜ì  HTML:</strong> `generate_html_analysis_report` í•¨ìˆ˜ê°€ í˜¸ì¶œë©ë‹ˆë‹¤. ë°ì´í„° ìƒ˜í”Œ, ì§ˆë¬¸, SQL ì¿¼ë¦¬ ë“±ì„ í¬í•¨í•œ ìƒì„¸í•œ í”„ë¡¬í”„íŠ¸ë¥¼ Claude ëª¨ë¸ì— ì „ë‹¬í•˜ì—¬ ë¶„ì„ ë‚´ìš©, ì°¨íŠ¸(Chart.js), ìŠ¤íƒ€ì¼(CSS)ì´ ëª¨ë‘ í¬í•¨ëœ ì™„ì „í•œ ë‹¨ì¼ HTML ë¬¸ì„œë¥¼ ìƒì„±í•˜ë„ë¡ ìš”ì²­í•©ë‹ˆë‹¤.</li>
                </ul>
            </div>

            <div class="step-explanation">
                <h3 class="text-xl font-semibold mb-2">6. ìµœì¢… ê²°ê³¼ í‘œì‹œ (Frontend)</h3>
                <p>Flask ë°±ì—”ë“œëŠ” ì²˜ë¦¬ëœ ìµœì¢… ê²°ê³¼(JSON í˜•ì‹)ë¥¼ í”„ë¡ íŠ¸ì—”ë“œë¡œ ì‘ë‹µí•©ë‹ˆë‹¤. `main.js`ì™€ `analysis.js`ì˜ JavaScript ì½”ë“œê°€ ì´ ì‘ë‹µì„ ë°›ì•„ ë™ì ìœ¼ë¡œ HTML ìš”ì†Œë¥¼ ìƒì„±í•©ë‹ˆë‹¤. `displayQuickResults`, `displayStructuredResults`, `displayCreativeHtmlResults` í•¨ìˆ˜ë“¤ì´ ê°ê°ì˜ ëª¨ë“œì— ë§ëŠ” UIë¥¼ ë Œë”ë§í•˜ë©°, í•„ìš”í•œ ê²½ìš° Chart.jsë¥¼ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ ì‹œê°í™”í•©ë‹ˆë‹¤.</p>
                 <code class="code-snippet text-sm">// static/js/analysis.js - displayStructuredResults(data)
document.getElementById('resultsSection').innerHTML = resultHtml;
if (data.chart_config) {
    createChart(data.data, data.chart_config);
}</code>
            </div>
        </section>

        <!-- 3. ê¸°ìˆ  ìŠ¤íƒ -->
        <section>
            <h2 class="section-title">ì‚¬ìš©ëœ ê¸°ìˆ  ìŠ¤íƒ</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-gray-50 p-6 rounded-lg">
                    <h3 class="text-xl font-semibold mb-3 text-gray-800">Frontend</h3>
                    <ul class="space-y-2 text-gray-700">
                        <li><strong>HTML5:</strong> ì›¹ í˜ì´ì§€ì˜ ê¸°ë³¸ êµ¬ì¡°</li>
                        <li><strong>Tailwind CSS:</strong> ë¹ ë¥´ê³  ìœ ì—°í•œ UI ê°œë°œì„ ìœ„í•œ CSS í”„ë ˆì„ì›Œí¬</li>
                        <li><strong>JavaScript (ES6+):</strong> ë¹„ë™ê¸° í†µì‹ (Fetch API) ë° ë™ì  UI ë Œë”ë§</li>
                        <li><strong>Chart.js:</strong> ë°ì´í„° ì‹œê°í™”ë¥¼ ìœ„í•œ JavaScript ë¼ì´ë¸ŒëŸ¬ë¦¬</li>
                    </ul>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <h3 class="text-xl font-semibold mb-3 text-gray-800">Backend</h3>
                    <ul class="space-y-2 text-gray-700">
                        <li><strong>Python 3.11:</strong> ì£¼ë ¥ ê°œë°œ ì–¸ì–´</li>
                        <li><strong>Flask:</strong> API ì„œë²„ êµ¬ì¶•ì„ ìœ„í•œ ê²½ëŸ‰ ì›¹ í”„ë ˆì„ì›Œí¬</li>
                        <li><strong>Gunicorn:</strong> í”„ë¡œë•ì…˜ í™˜ê²½ì„ ìœ„í•œ WSGI HTTP ì„œë²„</li>
                    </ul>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <h3 class="text-xl font-semibold mb-3 text-gray-800">AI / ML</h3>
                    <ul class="space-y-2 text-gray-700">
                        <li><strong>Anthropic Claude 3.5 Sonnet:</strong> ìì—°ì–´-SQL ë³€í™˜, ë°ì´í„° ë¶„ì„, ë¦¬í¬íŠ¸ ë° HTML ìƒì„± ë“± í•µì‹¬ì ì¸ AI ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ” ëŒ€ê·œëª¨ ì–¸ì–´ ëª¨ë¸(LLM)</li>
                    </ul>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <h3 class="text-xl font-semibold mb-3 text-gray-800">Database & Cloud</h3>
                    <ul class="space-y-2 text-gray-700">
                        <li><strong>Google BigQuery:</strong> ëŒ€ê·œëª¨ ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ ì„œë²„ë¦¬ìŠ¤ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤</li>
                        <li><strong>Google Cloud Run:</strong> ì»¨í…Œì´ë„ˆí™”ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ê³  í™•ì¥í•˜ê¸° ìœ„í•œ ì„œë²„ë¦¬ìŠ¤ í”Œë«í¼</li>
                        <li><strong>Google Secret Manager:</strong> API í‚¤ ë“± ë¯¼ê°í•œ ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ì €ì¥</li>
                    </ul>
                </div>
            </div>
        </section>

    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.8.1/flowbite.min.js"></script>
</body>
</html>
